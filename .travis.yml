language: java

jdk:
  - openjdk15

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: MGCYO0bKGWSOf5cBk5R4B57qW3n5354NMA+g1hfP5ZZEJrpEtQnREn/PeEywwpIzFuQcQN4Yo0flNn0kh1u3zqdTxznZKEKW253dTC3KioCyxnXrSRRqYusWPzkJMK9mXdTdvBa7UqCKg1/6cQPz/2/ri/SXIgqgdec/d35/4E2CnuXpTTB+yOdPHjBpeNLWRxOyecN2QuR0TIXSKxX0z7Jg/+7XJs1ZbBF+VxzepKC37LtrGt4UhYPfDsVVBswQqKDCw8pD+tUGJZdTYaGtA4FNveWhghNE5xk/GsMmHGK2+CsZuz+LZQYazDmrHPvj3U+Ep570DqqjknBpF0SRBwPVLM/OMh0Hi65rZADEL/aUf68XhGwu/33yOIudjDsgfpCcn8RNJQMDnOFdqf303kobCMXQWBbpPVdpCxQYaC4R6Q5HXAAbIXBJkhCu9Hjp53Wehw5zU2lY66hWMcHUycoRg2ZJUw7uZboB81iSYxyhuS7cG5H8TRFHif/qm8UNeTz6r4oLITPrmPRM39NoTE3gSbbQtq18llY84mqtTuMc9U3GP5vh0aVJ/sRAZ89VbzSUrQS9/SNfs9MLcIWp59cUWXg47ow2OKVdcsuOb4u38HivC6NBIL2FwCfP5+MLPPMiuCc7CAnmoZG2KOJ4h9syGaIpHABIBxl/nN+W5cg=
  file: "target/spt-development-cid-jms-spring-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
