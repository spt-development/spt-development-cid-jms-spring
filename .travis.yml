language: java

jdk:
  - openjdk8

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: Xj9VQ5ZGMnfoz6mKVGf3wGlPYWO2K3YUlJTvwNyxqsesbRDydHhmb0LZvdGEV/177KLiCszPzr0uYG6jEBGu9U1uimuMG4/a0qbcaggq9RzCYwEFlHD2/Q7J9THAa1PtqynhPMtDyzW8KQg5uqt6nv3a1lYiYwEEtpUEJNrAo0Thh5brMKvwfAsaI0Et+TaIigXCDUnhj/XO7jvlhltw+b68vb+gJAAf066K0NOkjy2Y4Xx4S33aYfqiHTQ9ZOHjkZoKL4xfqbURV0x9/BL9Pwm5zUVXY8Zi95iZ6OMssCmtlwFBSWvmmJ0ICXcQx4yUQXebM3RE1e6U/7RTACN8WWQg6LZE/SplvNuUpo2kUKpbAn90bssg8cNA8XwJnTJdDWNGwjhEJLv3Xvpqz+ykLF+P5EVMRrP3nYCpaL+4Q6HJypaKq60JjLo/Qtl9nsrS/SQmE4xLKZcByKVDzPlXzjH0qE1LtJJJ5JwtDIynxk5XjR2EyYwwplrhE+WgvKjMeZYOCOPfr5wl6HybdkzRc5GKuEkJIZFQL1WTWAUXDYoARgz+J6JyAVmtgdlTrvHLfqiJR+mAwt8+h+qUBTwkZaJpiVwgrJcdV3QiljnGaQritUWPy5wdeEhOPEKgqcDKGx2Cf9+Zv5iT5FB7pc9RWKd+9fptNaHDYSr874nha+I=
  file: "target/spt-development-cid-jms-spring-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
